<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Iron Golem - Improvements Test</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            color: white;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #testInfo {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 5px;
            z-index: 1000;
            max-width: 300px;
        }
        
        .test-item {
            margin: 5px 0;
            padding: 3px;
        }
        
        .test-pass {
            color: #4CAF50;
        }
        
        .test-fail {
            color: #F44336;
        }
        
        .test-pending {
            color: #FF9800;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="testInfo">
            <h3>🧪 Improvements Test</h3>
            <div class="test-item test-pending" id="test-models">📦 Detailed Character Models</div>
            <div class="test-item test-pending" id="test-camera">🎥 Mouse Camera Control</div>
            <div class="test-item test-pending" id="test-audio">🔊 Audio System</div>
            <div class="test-item test-pending" id="test-sounds">🎵 Sound Effects</div>
            <div class="test-item test-pending" id="test-music">🎼 Background Music</div>
            <hr>
            <div style="font-size: 12px; margin-top: 10px;">
                <strong>Controls:</strong><br>
                WASD - Move<br>
                Mouse - Look around<br>
                Left Click - Attack<br>
                U - Upgrade Shop<br>
                ESC - Pause
            </div>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Game Scripts -->
    <script src="src/core/AudioManager.js"></script>
    <script src="src/core/AssetLoader.js"></script>
    <script src="src/core/InputManager.js"></script>
    <script src="src/entities/Entity.js"></script>
    <script src="src/entities/IronGolem.js"></script>
    <script src="src/entities/Enemy.js"></script>
    <script src="src/entities/Resource.js"></script>
    <script src="src/systems/PhysicsSystem.js"></script>
    <script src="src/systems/CombatSystem.js"></script>
    <script src="src/systems/WaveSystem.js"></script>
    <script src="src/systems/ResourceSystem.js"></script>
    <script src="src/world/WorldGenerator.js"></script>
    <script src="src/ui/HUD.js"></script>
    <script src="src/ui/MenuSystem.js"></script>
    <script src="src/utils/MathUtils.js"></script>
    <script src="src/utils/GeometryUtils.js"></script>
    <script src="src/utils/StorageManager.js"></script>
    <script src="src/core/GameEngine.js"></script>
    <script src="src/main.js"></script>

    <script>
        // Test functions
        function updateTestStatus(testId, status, message = '') {
            const element = document.getElementById(testId);
            if (!element) return;
            
            element.className = `test-item test-${status}`;
            const icon = status === 'pass' ? '✅' : status === 'fail' ? '❌' : '⏳';
            element.innerHTML = `${icon} ${element.innerHTML.split(' ').slice(1).join(' ')} ${message}`;
        }

        // Run tests after game loads
        setTimeout(() => {
            runImprovementTests();
        }, 2000);

        function runImprovementTests() {
            console.log('🧪 Running improvement tests...');
            
            // Test 1: Detailed Character Models
            try {
                const ironGolem = window.game?.gameEngine?.ironGolem;
                if (ironGolem && ironGolem.bodyParts && Object.keys(ironGolem.bodyParts).length > 5) {
                    updateTestStatus('test-models', 'pass', '- Iron Golem has detailed body parts');
                } else {
                    updateTestStatus('test-models', 'fail', '- Missing detailed model');
                }
            } catch (error) {
                updateTestStatus('test-models', 'fail', '- Error loading models');
            }

            // Test 2: Mouse Camera Control
            try {
                const inputManager = window.game?.gameEngine?.inputManager;
                if (inputManager && typeof inputManager.onMouseMove === 'function') {
                    updateTestStatus('test-camera', 'pass', '- Mouse controls active');
                } else {
                    updateTestStatus('test-camera', 'fail', '- Mouse controls not found');
                }
            } catch (error) {
                updateTestStatus('test-camera', 'fail', '- Camera control error');
            }

            // Test 3: Audio System
            try {
                const audioManager = window.game?.gameEngine?.audioManager;
                if (audioManager && audioManager.audioContext) {
                    updateTestStatus('test-audio', 'pass', '- Web Audio API initialized');
                } else {
                    updateTestStatus('test-audio', 'fail', '- Audio system not initialized');
                }
            } catch (error) {
                updateTestStatus('test-audio', 'fail', '- Audio initialization error');
            }

            // Test 4: Sound Effects
            try {
                const audioManager = window.game?.gameEngine?.audioManager;
                if (audioManager && audioManager.soundBuffers && audioManager.soundBuffers.size > 0) {
                    updateTestStatus('test-sounds', 'pass', `- ${audioManager.soundBuffers.size} sound effects loaded`);
                } else {
                    updateTestStatus('test-sounds', 'fail', '- No sound effects found');
                }
            } catch (error) {
                updateTestStatus('test-sounds', 'fail', '- Sound effects error');
            }

            // Test 5: Background Music
            try {
                const audioManager = window.game?.gameEngine?.audioManager;
                if (audioManager && audioManager.currentMusicSource) {
                    updateTestStatus('test-music', 'pass', '- Background music playing');
                } else {
                    updateTestStatus('test-music', 'fail', '- Background music not playing');
                }
            } catch (error) {
                updateTestStatus('test-music', 'fail', '- Background music error');
            }

            // Test mouse movement after a delay
            setTimeout(() => {
                testMouseMovement();
            }, 1000);
        }

        function testMouseMovement() {
            try {
                const ironGolem = window.game?.gameEngine?.ironGolem;
                if (ironGolem) {
                    const originalRotation = ironGolem.cameraRotation.y;
                    ironGolem.rotateCamera(0.1, 0);
                    
                    if (ironGolem.cameraRotation.y !== originalRotation) {
                        updateTestStatus('test-camera', 'pass', '- Mouse rotation working');
                    } else {
                        updateTestStatus('test-camera', 'fail', '- Mouse rotation not responding');
                    }
                }
            } catch (error) {
                updateTestStatus('test-camera', 'fail', '- Mouse test error');
            }
        }

        // Test sound effects when user interacts
        document.addEventListener('click', () => {
            const audioManager = window.game?.gameEngine?.audioManager;
            if (audioManager) {
                audioManager.playSound('attack');
                console.log('🔊 Testing attack sound effect');
            }
        });

        document.addEventListener('keydown', (event) => {
            if (event.code === 'KeyW' || event.code === 'KeyA' || event.code === 'KeyS' || event.code === 'KeyD') {
                const audioManager = window.game?.gameEngine?.audioManager;
                if (audioManager) {
                    audioManager.playSound('footstep');
                    console.log('🔊 Testing footstep sound effect');
                }
            }
        });
    </script>
</body>
</html> 